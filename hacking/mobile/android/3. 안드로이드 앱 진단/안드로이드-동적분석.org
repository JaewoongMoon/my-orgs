#+TITLE: 안드로이드 동적 분석


* 개념
- 어플리케이션의 동작을 분석하는 방법이다. 
- 다양한 방법을 사용할 수 있다. 


* 메모리 변조하기
- 게임 어플리케이션 같은 경우 게임 머니나 스테이터스 등을 메모리 변조를 통해 바꿀 수 있는 경우가 있다. 
- 그런 것을 테스트하기 위해 사용한다. 


* 디스어셈블하기
- apk 파일의 소스코드를 가지고 있지 않고 컴파일된 소스만 가지고 있을 때, 역어셈블한 코드를 디버거에 로딩해서 프로그램을 디버깅할 수 있는 방법이다.
- 동적 디버깅을 해보면서 프로그램 동작을 파악한다.
- (JAVA 코드 분석 결과를 토대로)어셈블리 코드를 해커에게 유리하게 수정할 수 있다. 
- 코드를 변조한 후 재패키징해서 다시 안드로이드에 설치해서 실행해본다. 
- 변조된대로 동작하는지 확인한다.


* 코드 재패키징하기



* 동적디버깅
- apk파일을 디버거에 올려서 동적으로 행동을 테스트하는 방법이다.
- 예전에 했던 방법들이 현재는 안되는 것 같다. 
- 직접 소스코드를 가지고 있는 경우라면 당연히 동적 디버깅이 되지만, 소스 코드 없이 apk파일이나 디스어셈블된 파일만을 가지고 하는 것은 예전에 테스트해본 결과 잘 되지 않았다. 
- 현재는 뭔가 새롭고 더 좋은 방법이 나왔을지도?


** 필요조건
- 매니페스트 파일에 debuggable=true 로 세팅이 되어있어야 한다.
- 이게 안되어 있다면 apktool 등을 이용해서 매니페스트 파일을 복원한뒤 해당 값을 세팅하고 다시 재패키징 해야 한다.  


* 패킷 캡처하기
- 앱에 따라 안드로이드에서 프록시 기능이 켜져 있으면 제대로 동작하지 않는 경우도 있다. 
- 이럴 때는 패킷 캡처 앱을 사용한다. 
- 'Packet Capture'라는 앱을 설치하고 설정과정에서 몇 번의 버튼 터치로 SSL 인증서도 설치할 수 있다. 
- SSL 인증서를 설치하면 HTTPS 패킷도 볼 수 있다. 


* 



