#+TITLE: HTTP 및 웹 어플리케이션 취약점 대책

* HTTP와 웹 어플리케이션 구조

* 세션 관리 취약점 대책
** 세션 관리의 취약점
- 패킷도청에 의해 세션정보가 노출될 가능성이 있음(HTTP)
- 세션ID가 추측, 변조되어 타자에 정보가 노출될 가능성이 있음 (추측하기 쉬운 세션ID)
- 세션ID를 서버과 클라이언트 사이에 주고받음으로 제3자에게 정보가 누출될 가능성이 있음 (특히 GET메서드로 교환하는 경우)
- Referrer 로그를 보고 다른 웹 사이트 관리자에게 세션정보가 노출될 가능성이 있다. (특히 GET메서드로 교환하는 경우)
- hidden 필드 변조에 의해 부정한 처리가 실행될 가능성이 있다. 
- XSS 취약점으로 인해, 쿠키에 설정된 세션정보를 빼앗길 가능성이 있다. 
- 쿠키의 속성설정 문제로 인해 쿠키에 설정된 세션정보를 빼앗길 가능성이 있다. (secure속성, 필요이상으로 긴 유효기간, 유효범위 설정)
- 웹 서버에서 URL Rewriting 기능이 켜져있으면, 의도적인 세션정보 쿼리 스트링 설정으로 사용할 가능성이 있다. (Session Fixation)
- 세션관리 버그로 인해 원래 인증을 필요로 하는 웹 페이지의 인증 프로세스를 우회할 가능성이 있다. 


** 세션 관리의 취약점 대책
- HTTPS 사용
- 세션정보는 모두 서버측에서 관리
- 추측하기 어려운 긴 , 난수를 사용한 세션ID
- POST 메서드를 이용해 세션ID를 은폐 
- 쿠키의 유효기간을 가능한한 짧게, 유효범위를 가능한한 좁게 설정
- HTTPS로 접속하는 웹 페이지에는 쿠키 속성을 secure로
- 입력데이터 필터링(XSS대책)
- URL Rewriting 무효화
- 인증이 필요한 페이지에서 확실히 인증을 수행, 해당 페이지가 검색 엔진이나 캐시서버에 등록되지 않도록 설정(meta 태그 등)
- 세션관리 기능을 직접 구현하지 말고, 웹서버/WAS의 기능을 사용
- 로그인 후에는 새로운 세션ID를 발급하도록 한다.
- WAF 도입

* HTTP 의 구조에 의한 취약점과 대책
** HTTP 프로토콜 사양에 의한 취약점
1. 평문 통신이기 때문에 내용이 도청될 수 있음
2. 베이직 인증의 취약점으로 인한 정보 누출 가능성(단순한 BASE64인코딩, 원래 정보 복원 용이)

** HTTP 프로토콜 사양에 의한 취약점 대책
- HTTPS
- 베이직 인증은 가능한한 사용하지 말고, 인증용 입력 폼을 이용한 인증(폼 인증) 혹은 챌린지 리스폰스 방식(HTTP 다이제스트 인증)으로 인증정보를 숨기기


* 웹 서버의 구현이나 설정 실수에 의한 취약점과 대책
** 웹 서버구현이나 설정 실수에 의한 취약점
- 디렉토리 설정 실수로 디렉토리 트래버셜 공격을 당할 수 있음
- 에러 메세지 출력 설정 실수로 인해 중요 정보가 노출됨
- HTTP 응답 헤더 정보로 서버 프로그램이나 버전이 노출됨
- 서버 버전에 따라 BOF공격등을 당할 가능성
- 커맨드나 메서드 설정 실수로 인해 컨텐츠의 변조나 관리 정보가 노출될 수 있음 (PUT, TRACE 메서드 등)

** 웹 서버구현이나 설정 실수에 의한 취약점 대책
- 웹 서버 버전을 은폐
- 필요없는 커맨드 무효화
- 디렉토리 접근권한을 적절하게 설정
- 디렉토리 참조를 금지
- 상세 에러 메세지를 출력하지 않도록 설정
- IPS, WAF 등 도입

* 웹 어플리케이션의 구조와 구현에 의한 취약점과 대책
** 웹 어플리케이션의 구조와 구현에 의한 취약점
- XSS
- SQL 인젝션
- OS 커맨드 인젝션 (임의의 파일 열람, 변경, 삭제, 패스워드 취득 등)
- HTTP 헤더 인젝션 (개행 코드 입력으로 HTTP 헤더 분리)
- 메일 헤더 인젝션 (개행 코드 입력으로 메일 헤더 추가, 부정메일이 송신될 가능성)


** 웹 어플리케이션의 구조와 구현에 의한 취약점 대책
- SQL 쿼리에 바인드 메커니즘 사용(SQL 인젝션 대책)
- 유저 입력데이터 이스케이프 처리
- 웹 어플리케이션에서 DB서버에 요청가능한 쿼리의 종류를 필요 최소한으로 제한(SQL 인젝션 대책)
- 웹 어플리케이션 구현시 OS커맨드를 호출가능한 함수를 사용하지 않는다. (OS 커맨드 인젝션 대책)
- WAF 도입

