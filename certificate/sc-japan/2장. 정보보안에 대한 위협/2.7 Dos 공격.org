#+TITLE: Dos 공격

* Dos 공격의 종류와 대책
Dos 공격에는 다음과 같은 종류가 있다.
1. CPU나 메모리 등 시스템 자원을 과부하 상태 혹은 오버플로우 상태로 만든다.
2. 대량의 패킷을 보내 네트워크 대역을 넘치게 한다.
3. 호스트의 보안홀을 이용해서 OS나 특정 어플리케이션을 이상종료 시킨다. 

이 중에 비교적 잘 일어나는 것이 2번이다. 2번은 공격하는 측의 규모가 클수록 피해 규모도 커진다. 
버퍼 오버플로 공격같은 것은 3번에 해당됨.


** 1. SYN Flood 공격
- TCP 접속 개시 요구인 SYN 패킷을 대량으로 보내는 것으로 정상적인 서비스 제공을 방해하는 것
- 위 종류 중 1번에 (규모에 따라서는 2번에) 해당한다. 
- 공격자는 발신자 IP를 위조한 SYN 패킷을 대량으로 보낸다. 
- 서버는 각 발신자IP로 SYN/ACK을 보내지만 당연히 응답은 없다.
- 서버는 각 요구를 테이블에 세팅하고 타임아웃이 될 때까지 기다린다.
- 이윽고 서버의 리소스가 모두 사용되고 정당한 요구에 대해서 서비스를 제공하지 못하게 된다.
- 이 공격은 발신자 IP가 위조되어 있어서 공격자의 IP을 특정하기가 어렵다.

*** 대책
- SYN 쿠키나 SYN Flood 프로텍션 기능을 가진 OS나 방화벽을 사용
- 커넥션 확립시의 타임아웃 시간을 짧게 한다.
- 라우터나 스위치에서 SYN패킷의 대역을 제한한다.

*** SYN 쿠키
- TCP 통신의 정당성을 확인하기 위해, SYN/ACK 패킷의 시퀀스 번호에 심어두는 데이터
- 보통 TCP 헤더를 해시화한 값이 사용된다.
- 클라이언트로부터 SYN패킷을 받은 단계에서는 TCP소켓을 오픈하지 않고, SYN쿠키를 세팅한 SYN/ACK패킷을 클라이언트에게 전송한다.
- 이후, 클라이언트로부터 받은 ACK패킷을 확인하고 정당한 통신일 경우만 소켓을 열어서 TCP 커넥션을 확립한다.

SYN Flood 공격은 옛날부터 사용되어온 Dos공격의 대표격인 공격이다. 

최근의 일반적인 서버OS나 방화벽에는 이 공격에 대한 대책이 마련되어 있으나 완벽하지 않아서 최근에도 피해가 발생하고 있다.

** 2. UDP Flood 공격
- 타겟 서버의 UDP 포트로 사이즈가 큰 대량의 UDP 패킷을 보낸다.
- 위 종류의 1번(규모에 따라서 2번)에 해당한다.
- 또한 사이즈가 아주 작은 UDP 패킷을 대량으로 보내는 수법도 있는데, 이는 주로 방화벽이나 네트웍 기기에 부담을 주기위한 공격이다. 
- UDP는 커넥션리스이므로, 발신자 IP를 위조하는 것이 쉽다.
- 따라서 대부분의 UDP Flood공격의 발신자 IP는 위조되어 있다. 
- 그 결과, 공격자 IP를 특정하기 어렵다.

*** 대책
- 불필요한 UDP 서비스를 중지한다.
- 불필요한 UDP 서비스로의 접근을 방화벽에서 필터링한다.
- 라우터나 스위치에서 UDP 패킷의 대역을 제한한다.

** ICMP Flood (Ping Flood) 공격
- 타겟 호스트에 대해 사이즈가 큰 ICMP echo request (ping)를 대량으로 보내는 공격
- 위 종류의 1번(규모에 따라서 2번)에 해당한다.
- ICMP 도 UDP와 마찬가지로 발신자 IP위조가 쉽고, 따라서 공격자 IP를 특정하기 어렵다.

*** 대책
- 라우터나 방화벽에서 ICMP 패킷을 차단(모든 ICMP패킷을 차단하기 어려우면 타입 코드별로 중계 여부를 설정)
- 위의 방법이 불가능하면 라우터나 스위치에서 ICMP 패킷의 대역 제한을 건다.

** 3. smurf 공격
- 발신자 IP주소를 위조한 ICMP echo request로 타겟 호스트가 접속된 네트워크의 대역을 넘치게 하는 공격
- 공격자는 타겟 호스트의 IP를 발신자 IP로 세팅, 네트워크 세그먼트의 브로드캐스팅 주소로 ICMP echo request를 보낸다.
- 요청을 받은 네트워크 세그멘트의 각 호스트들은 위조된 발신자 IP 주소로 ICMP echo reply를 일제히 보낸다.
- 응답을 회신하는 호스트 수가 많을 수록 대량의 패킷이 일제히 발송된다.
- 그 결과 해당 네트워크는 패킷으로 폭주하게 되어 정당한 패킷에 대해 서비스하지 못하게 된다.

*** 대책
- 라우터나 방화벽에서 ICMP패킷을 차단(적어도 ICMP echo reply는 차단한다)
- 위의 방법이 여의치 않으면 라우터나 스위치에서 ICMP패킷의 대역을 제한한다.
- 브로드캐스팅 주소를 향한 패킷을 차단한다. (공격의 발판이 되지 않도록)

** 4. Connection Flood 공격
- 타겟 호스트의 TCP 포트에 대해 차례차례 커넥션을 확립해 나가는 대량의 프로세스를 기동한다.
- 위의 분류에서는 1에 해당
- 실제로 커넥션을 확립하기 때문에 발신자 IP를 위조하기는 어렵다. 
- 그렇지만 규모에 따라 실제로 호스트에 피해를 입힐 가능성이 높다.

*** 대책
- 호스트의 소켓 오픈 수나 TCP 큐의 할당 수를 늘린다.
- 호스트의 설정으로 같은 IP로부터의 동시접속수를 제한한다.
- 호스트의 이중화 구성이나 로드 발란서등을 사용해 부담분산을 한다.
- 라우터나 방화벽으로 공격자 IP로부터의 패킷을 차단한다.


** 5. DDos 공격

** 6. 반사/증폭형 DDos 공격
'
** 7. EDos 공격


* Dos 공격에의 종합적인 대책
** 예방 / 방지

** 탐지 / 추적

** 회복

